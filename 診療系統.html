<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAWER é‹¸ç‰‡é†«ç”Ÿè¨ºç™‚ç³»çµ± | è™•æ–¹é‹¸ç‰‡å¿«é€Ÿè¨ºæ–·</title>
    <style>
        /* --- åŸºç¤é€ å‹èˆ‡å“ç‰Œé¢¨æ ¼ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 40px auto;
            padding: 30px;
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-top: 5px solid #004488; /* HAWER å“ç‰Œè‰² */
            border-radius: 8px;
        }
        h1 {
            color: #004488;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 24px;
        }
        .section-title {
            color: #444;
            margin-top: 25px;
            margin-bottom: 15px;
            padding: 5px 0;
            border-left: 5px solid #ffcc00; /* äº®é»ƒè‰²ä½œç‚ºé‡é»æ¨™ç¤º */
            padding-left: 10px;
            font-size: 18px;
            font-weight: bold;
        }

        /* --- è¡¨å–®å…ƒç´ é€ å‹ --- */
        label {
            display: block;
            margin-top: 15px;
            font-weight: 600;
        }
        input[type="text"], input[type="email"], input[type="number"], textarea, select {
            width: 98%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input:focus, textarea:focus, select:focus {
            border-color: #004488;
            outline: none;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        .checkbox-group label {
            display: inline-block;
            margin-right: 15px;
            font-weight: normal;
        }

        /* --- æŒ‰éˆ•é€ å‹ --- */
        button {
            background-color: #004488;
            color: white;
            padding: 12px 20px;
            margin-top: 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #003366;
        }

        /* --- è¨Šæ¯æç¤ºå€ --- */
        #message-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
        }
        .success {
            background-color: #e6ffe6;
            color: #008000;
            border: 1px solid #008000;
        }
        .error {
            background-color: #ffe6e6;
            color: #ff0000;
            border: 1px solid #ff0000;
        }
        .loading {
            background-color: #f0f8ff;
            color: #004488;
        }
    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
        <h1 style="border: none;">HAWER é‹¸ç‰‡é†«ç”Ÿè¨ºç™‚ç³»çµ±</h1>
        <p>æ„Ÿè¬æ‚¨å°é‹¸ç‰‡é†«ç”Ÿçš„ä¿¡ä»»ï¼Œè«‹æä¾›ä»¥ä¸‹è³‡è¨Šï¼Œæˆ‘å€‘å°‡ç‚ºæ‚¨é–‹ç«‹å°ˆå±¬ã€è™•æ–¹é‹¸ç‰‡ã€‘ã€‚</p>
    </div>

    <form id="diagnosisForm">

        <div class="section-title">I. è¯çµ¡è³‡è¨Š (è¨ºæ–·å ±å‘Šå¯„é€)</div>
        <label for="name">å§“å / å…¬å¸åç¨±:</label>
        <input type="text" id="name" required>

        <label for="email">è¯çµ¡ Email:</label>
        <input type="email" id="email" required>

        <label for="phone">è¯çµ¡é›»è©±:</label>
        <input type="text" id="phone">

        <div class="section-title">II. ç›®å‰ä½¿ç”¨é‹¸ç‰‡è¦æ ¼</div>
        <label for="outerDiameter">é‹¸ç‰‡å¤–å¾‘ (D, mm):</label>
        <input type="number" id="outerDiameter" required>

        <label for="teethCount">é‹¸ç‰‡é½’æ•¸ (T):</label>
        <input type="number" id="teethCount" required>

        <label for="kerf">é½’åš / åˆ‡å¹… (Kerf, mm):</label>
        <input type="text" id="kerf" placeholder="ä¾‹å¦‚ï¼š3.2">

        <label for="brand">ç›®å‰ä½¿ç”¨é‹¸ç‰‡å“ç‰Œ:</label>
        <input type="text" id="brand">


        <div class="section-title">III. æ©Ÿå°èˆ‡åˆ‡å‰Šç‰©æè¿°</div>
        <label for="rpm">æ©Ÿå°è½‰é€Ÿ (RPM):</label>
        <input type="number" id="rpm" placeholder="ä¾‹å¦‚ï¼š4500">
        
        <label for="material">åˆ‡å‰Šç‰©æè³ª:</label>
        <input type="text" id="material" required placeholder="ä¾‹å¦‚ï¼šAL6061-T6 é‹åˆé‡‘ã€èœ‚å·¢é‹">

        <label for="thickness">åˆ‡å‰Šç‰©åšåº¦æˆ–å£åš (H, mm):</label>
        <input type="text" id="thickness" required placeholder="ä¾‹å¦‚ï¼š50mm (å¡Šæ) æˆ– 3mm (ç®¡æå£åš)">
        
        <label for="type">åˆ‡å‰Šç‰©å‹æ…‹:</label>
        <select id="type" required>
            <option value="">-- è«‹é¸æ“‡ --</option>
            <option value="pipe">ç®¡æ</option>
            <option value="bar">æ£’æ/å¯¦å¿ƒæ¢</option>
            <option value="plate">æ¿æï¼ˆè–„ï¼‰</option>
            <option value="block">å¡Šæ/é‘„ä»¶ï¼ˆåšï¼‰</option>
            <option value="composite">ç‰¹æ®Šè¤‡åˆæ/èœ‚å·¢æ</option>
        </select>

        <label>æ½¤æ»‘/å†·å»æ–¹å¼:</label>
        <div class="checkbox-group">
            <label><input type="checkbox" name="lubrication" value="oil"> åˆ‡å‰Šæ²¹ / ä¹³åŒ–æ¶²</label>
            <label><input type="checkbox" name="lubrication" value="mist"> æ²¹éœ§æ½¤æ»‘</label>
            <label><input type="checkbox" name="lubrication" value="wax"> æ½¤æ»‘è Ÿ / è‚¥çš‚</label>
            <label><input type="checkbox" name="lubrication" value="none"> ç„¡æ½¤æ»‘ (ä¹¾åˆ‡)</label>
        </div>


        <div class="section-title">IV. å›°æ“¾æè¿°èˆ‡è¦–è¦ºè³‡æ–™ (è¼”åŠ©è¨ºæ–·)</div>
        <label for="problemDesc">é‹¸ç‰‡ä½¿ç”¨å›°æ“¾æè¿° (ä¾‹å¦‚ï¼šå£½å‘½çŸ­ã€é»å±‘ã€æ¯›é‚Šå¤§):</label>
        <textarea id="problemDesc" required></textarea>

        <label for="fileLink">ç…§ç‰‡/å½±ç‰‡é€£çµ (å¦‚ Google Drive æˆ– Imgur é€£çµ):</label>
        <input type="text" id="fileLink" placeholder="è«‹æä¾›ç…§ç‰‡/å½±ç‰‡é€£çµï¼Œå°‡å¤§å¹…æé«˜è¨ºæ–·æº–ç¢ºåº¦">

        <button type="submit" id="submitButton">ğŸ¤– æäº¤è³‡æ–™ä¸¦ç²å– AI è¨ºæ–·å ±å‘Š</button>
    </form>
    
    <div id="message-area"></div>
</div>

<script>
    // ** è«‹å‹™å¿…æ›¿æ›æˆæ‚¨éƒ¨ç½²å¾Œçš„ Google Apps Script Web App ç¶²å€ **
    const GAS_WEB_APP_URL = 'è²¼ä¸Šæ‚¨éƒ¨ç½²å¾Œçš„ GAS Web App ç¶²å€ï¼Œç¶²å€çµå°¾æ‡‰ç‚º /exec æˆ– /dev'; 

    document.getElementById('diagnosisForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const messageArea = document.getElementById('message-area');
        const submitButton = document.getElementById('submitButton');

        // æª¢æŸ¥ GAS URL æ˜¯å¦å·²æ›¿æ›
        if (GAS_WEB_APP_URL.includes('è²¼ä¸Šæ‚¨éƒ¨ç½²å¾Œçš„ GAS Web App ç¶²å€')) {
            messageArea.className = 'error';
            messageArea.innerHTML = '<strong>ç¨‹å¼éŒ¯èª¤ï¼š</strong>è«‹è¯ç¹«æ‚¨çš„é–‹ç™¼äººå“¡ï¼Œæ›¿æ›ç¨‹å¼ç¢¼ä¸­çš„ GAS_WEB_APP_URLã€‚';
            return;
        }

        // æ”¶é›†æ½¤æ»‘æ–¹å¼
        const lubricationChecks = document.querySelectorAll('input[name="lubrication"]:checked');
        const lubricationValues = Array.from(lubricationChecks).map(cb => cb.value);

        // æ”¶é›†è¡¨å–®æ•¸æ“š
        const formData = {
            ClientName: document.getElementById('name').value,
            Email: document.getElementById('email').value,
            Phone: document.getElementById('phone').value,
            OuterDiameter: document.getElementById('outerDiameter').value,
            TeethCount: document.getElementById('teethCount').value,
            Kerf: document.getElementById('kerf').value,
            Brand: document.getElementById('brand').value,
            RPM: document.getElementById('rpm').value,
            Material: document.getElementById('material').value,
            Thickness: document.getElementById('thickness').value,
            Type: document.getElementById('type').value,
            Lubrication: lubricationValues, // å‚³é€é™£åˆ—
            ProblemDesc: document.getElementById('problemDesc').value,
            FileLink: document.getElementById('fileLink').value
        };

        // é¡¯ç¤ºè¼‰å…¥ä¸­
        messageArea.className = 'loading';
        messageArea.innerHTML = '<strong>è¨ºæ–·é€²è¡Œä¸­...</strong> è«‹ç¨å€™ï¼ŒAI é†«ç”Ÿæ­£åœ¨åˆ†ææ•¸æ“šä¸¦æº–å‚™å ±å‘Š...';
        submitButton.disabled = true;

        try {
            const response = await fetch(https://script.google.com/macros/s/AKfycbxgiaOTv1sdEqWOK59YSkzsZvW1vjeu_EwMVcDVm4XG8lEFNSgMfAiuYy2_CoDG4GS6vQ/exec, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            });

            if (!response.ok) {
                throw new Error(`HTTP éŒ¯èª¤ï¼šç‹€æ…‹ç¢¼ ${response.status}`);
            }

            const result = await response.json();

            if (result.success) {
                messageArea.className = 'success';
                messageArea.innerHTML = `
                    <strong>âœ… æäº¤æˆåŠŸï¼</strong>
                    è¨ºæ–·å ±å‘Šå·²å¯„é€è‡³æ‚¨çš„ä¿¡ç®±ï¼š${formData.Email}ã€‚<br>
                    è«‹ç«‹å³æª¢æŸ¥æ‚¨çš„ä¿¡ç®± (åŒ…å«åƒåœ¾éƒµä»¶)ã€‚<br>
                    <a href="https://lin.ee/6XPlLiM" target="_blank" style="color: #008000; font-weight: bold;">é»æ­¤è¯ç¹« HAWER å°ˆäººé€²è¡Œç²¾æº–å ±åƒ¹ (æ¨è–¦)</a>
                `;
                document.getElementById('diagnosisForm').reset(); // æ¸…ç©ºè¡¨å–®
            } else {
                messageArea.className = 'error';
                messageArea.innerHTML = `<strong>ç³»çµ±éŒ¯èª¤ï¼š</strong>ç„¡æ³•å®Œæˆè¨ºæ–·ã€‚éŒ¯èª¤è¨Šæ¯ï¼š${result.message || 'æœªçŸ¥éŒ¯èª¤'}ã€‚è«‹ç¨å¾Œé‡è©¦æˆ–ç›´æ¥ä¾†é›» 06-2305390ã€‚`;
            }

        } catch (error) {
            console.error('Fetch Error:', error);
            messageArea.className = 'error';
            messageArea.innerHTML = `<strong>é€£ç·šå¤±æ•—ï¼š</strong>ç„¡æ³•é€£ç·šè‡³è¨ºæ–·ä¼ºæœå™¨ã€‚è«‹ç¢ºèª Web App ç¶²å€æ­£ç¢ºæˆ–ç¨å¾Œå†è©¦ã€‚éŒ¯èª¤è¨Šæ¯ï¼š${error.message}`;
        } finally {
            submitButton.disabled = false;
        }
    });
</script>

</body>
</html>